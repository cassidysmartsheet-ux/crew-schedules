<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cassidy Paving Schedule Display</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            /* --- BRAND SETTINGS (CASSIDY PAVING) --- */
            --brand-color: #CC0000;  /* Strong Red for accents & text */
            --brand-bg: #FFFFFF;     /* White background for Title Bar */
            --brand-text: #CC0000;   /* Red text for Title */
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #222;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        /* THE VIRTUAL CONTAINER 
           Resolution set to 1280x720 (720p).
           This is the "Sweet Spot". It forces Smartsheet to show the Calendar View (Desktop),
           but because it's 720p, the text and banners appear 1.5x larger on a 1080p/4K TV.
        */
        #virtual-desktop {
            width: 1280px;
            height: 720px;
            position: absolute;
            top: 0;
            left: 0;
            transform-origin: top left;
            /* JS will apply transform: scale() here to fit the actual TV screen */
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0; /* Hidden until loaded */
            transition: opacity 1s ease-in-out;
        }

        iframe.active {
            opacity: 1;
            z-index: 10;
        }

        /* CUSTOM TITLE BAR OVERLAY */
        #title-bar {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 60px;
            
            background-color: var(--brand-bg);
            border-bottom: 4px solid var(--brand-color);
            color: var(--brand-text);
            
            display: flex;
            align-items: center;
            justify-content: center;
            
            font-family: 'Oswald', sans-serif;
            font-size: 32px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            
            z-index: 100; /* Stays on top of Smartsheet */
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }

        /* CONFIDENCE TIMESTAMP */
        #timestamp {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.85);
            border-left: 4px solid var(--brand-color);
            color: #ffffff;
            padding: 8px 15px;
            border-radius: 0 5px 5px 0;
            font-family: 'Oswald', sans-serif;
            font-size: 14px;
            letter-spacing: 1px;
            z-index: 100;
        }
    </style>
</head>
<body>

    <div id="virtual-desktop">
        
        <div id="title-bar">PAVING CREW 1 SCHEDULE</div>

        <iframe class="active" src="https://app.smartsheet.com/b/publish?EQBCT=18bf92d8334949ed8501b4134698b25e"></iframe>
    
    </div>

    <div id="timestamp">Initializing...</div>

    <script>
        // Update the timestamp immediately on load
        function updateTime() {
            const now = new Date();
            document.getElementById('timestamp').innerText = 'LAST REFRESHED: ' + now.toLocaleTimeString();
        }
        updateTime();

        // SCALING LOGIC (The "Magic" Fit)
        function resizeContainer() {
            const container = document.getElementById('virtual-desktop');
            
            // Matches the CSS width/height above
            const targetWidth = 1280;
            const targetHeight = 720;

            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;
            
            // Calculate scale to fit our 720p container into ANY screen size
            const scaleX = windowWidth / targetWidth;
            const scaleY = windowHeight / targetHeight;
            const scale = Math.min(scaleX, scaleY);
            
            container.style.transform = `scale(${scale})`;
        }

        // Run on load and whenever window changes
        window.addEventListener('resize', resizeContainer);
        resizeContainer();

        // AUTO-REFRESH LOGIC
        // Reloads the entire page every 10 minutes (600,000 ms)
        setTimeout(() => window.location.reload(), 600000);
    </script>
</body>
</html>